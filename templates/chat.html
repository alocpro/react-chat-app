{% extends 'base.html' %}

{% block js %}
    <script type="text/javascript" src="socket.io/socket.io.js"></script>
    <script type="text/javascript" src="media/js/models.js"></script>
    <script type="text/javascript" src="media/js/views.js"></script>
    <script type="text/javascript" src="media/js/client.js"></script>
    <script type="text/javascript">
        window.client = new window.LCB.Client();
        $(function() {
           window.client.start();
        });
    </script>
{% endblock %}

{% block attributes %}
    ng-app="lets-chat"
{% endblock %}

{% block templates %}
{% raw %}
    <script type="text/x-handlebars-template" id="template-room-browser-item">
        <li data-id="{{ id }}" class="lcb-rooms-list-item">
            <a href="#!/room/{{id}}">{{ name }}</a>
        </li>
    </script>
    <script type="text/x-handlebars-template" id="template-room">
        <div class="lcb-room" data-id="{{ id }}">
            <section class="lcb-room-sidebar">
                <div class="lcb-room-meta">
                    <h2 class="lcb-room-heading">{{ name }}</h2>
                    <div class="lcb-room-description">
                        <p>{{ description }}</p>
                    </div>
                </div>
                <div class="lcb-room-actions btn-groups">
                    <button class="btn btn-default"><i class="fa fa-cloud"></i></button>
                    <button class="btn btn-default"><i class="fa fa-cloud"></i></button>
                    <button class="btn btn-default"><i class="fa fa-cloud"></i></button>
                </div>
                <div class="lcb-item-list">
                    <h3 class="lcb-item-list-heading">Users</h3>
                    <ul>
                        <li ng-repeat="user in users">
                            <img class="lcb-item-list-avatar" src="https://www.gravatar.com/avatar/{$ user.avatar $}?s=50" />
                            <div class="lcb-item-list-meta">
                                  {$ user.name $}
                            </div>
                        </li>
                    </ul>
                </div>
            </section><!-- lcb-room-sidebar end -->
            <section class="lcb-chat">
                <ul class="lcb-messages">
                    <li class="lcb-message" ng-repeat="message in messages">
                        <img class="lcb-message-avatar" src="https://www.gravatar.com/avatar/{$ message.owner.avatar $}?s=50" />
                        <div class="meta">
                            <span class="lcb-message-name">{$ message.owner.name $}</span>
                            <time class="lcb-message-time">{$ message.time $}</time>
                            <ul class="lcb-message-fragments">
                                <li class="lcb-message-fragment">{$ message.text $}</li>
                            </ul>
                        </div>
                    </li>
                </ul>
                <form class="lcb-entry">
                    <textarea class="lcb-entry-input" placeholder="Got something to say?"></textarea>
                    <button type="submit" class="btn btn-info lcb-entry-button" data-click="send()">Send</button>
                </form>
            </section><!-- lcb-chat end -->
        </div><!-- lcb-room end -->
    </script>
{% endraw %}
{% endblock %}

{% block body %}
    <div id="lcb-client" class="lcb-client" ng-controller="client-controller">
        <header class="lcb-header"></header>
        <section class="lcb-main">
            <section class="lcb-sidebar">
                    <span class="lcb-account btn btn-info btn-block" href="#">
                        <img class="avatar" src="http://www.gravatar.com/avatar/bfa5bfae39ce7bdd1e0f385c961d4afa?s=50" />
                        <span class="name">{{ account.displayName }}</span>
                        <b class="caret"></b>
                    </span>
                    <div class="lcb-rooms-browser">
                        <h2 class="lcb-sidebar-heading">
                            <i class="fa fa-list"></i> Rooms
                        </h2>
                        <ul class="lcb-rooms-list" data-bind="collection:$collection"></ul>
                    </div>
                    <!--
                    <h2 class="lcb-sidebar-heading">Account Info</h2>
                    <table>
                        <tbody>
                            {% for property, value in account %}
                                <tr>
                                    <td>{{ property }}</td>
                                    <td>{{ value }}</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table> -->
            </section><!-- lcb-sidebar end -->
            <section class="lcb-rooms"></section>
        </section><!-- lcb-main end -->
    </div><!-- lcb-client end -->
{% endblock %}